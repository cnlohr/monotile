<html>
<head>
<script>
function getCookie(cname) {
	let name = cname + "=";
	let decodedCookie = decodeURIComponent(document.cookie);
	let ca = decodedCookie.split(';');
	for(let i = 0; i <ca.length; i++) {
		let c = ca[i];
		while (c.charAt(0) == ' ') {
			c = c.substring(1);
		}
		if (c.indexOf(name) == 0) {
			return c.substring(name.length, c.length);
		}
	}
	return "";
}

function sysload()
{
	let loginelem = document.getElementById( "loginprops" );
	let userlogin = getCookie("userlogin");
	if( userlogin === "" || userlogin == "" )
	{
		console.log( "No username found" );
		let loginurl = "https://github.com/login/oauth/authorize?client_id=4a55dbe35237fa207491&state=" + Math.random();
		loginelem.innerHTML = '<a href="' + loginurl + '">Github Auth</a> (TODO: Warn about Cookies)';
	}
	else
	{
		let useravatar = getCookie("useravatar");
		loginelem.innerHTML = 
			'<table><tr><td><img src="' + getCookie("useravatar") + '" width=50></td><td>' +
			'Welcome,<br>' + userlogin + '<br><a href=logout.cgi><font size=-3>Logout</font></a>' +
			'</td></tr></table>';
	}
}
</script>
<body onload=sysload()>

<table border=1>
<tr><td>
<div id=loginprops>
identity
</div>
<td><div id=hud></div>
</td></tr>
</table>

</body>
</html>
